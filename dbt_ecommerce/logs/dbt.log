[0m19:14:44.282613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ed340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ed0a0>]}


============================== 19:14:44.286220 | 7f1134bf-8157-465c-83c9-edffc8bdeaff ==============================
[0m19:14:44.286220 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:14:44.286532 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run'}
[0m19:14:44.286886 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m19:14:44.288490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05170225, "process_in_blocks": "0", "process_kernel_time": 0.10945, "process_mem_max_rss": "103071744", "process_out_blocks": "0", "process_user_time": 0.640625}
[0m19:14:44.288747 [debug] [MainThread]: Command `dbt run` failed at 19:14:44.288702 after 0.05 seconds
[0m19:14:44.288911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ed100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ed010>]}
[0m19:14:44.289089 [debug] [MainThread]: Flushing usage events
[0m19:14:44.783358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:12.245102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c92cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9160>]}


============================== 19:16:12.249338 | b3a36b58-1702-4eb2-a12a-32f8c7845471 ==============================
[0m19:16:12.249338 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:16:12.249650 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'log_path': 'logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m19:16:12.250000 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m19:16:12.250914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.046075918, "process_in_blocks": "0", "process_kernel_time": 0.113451, "process_mem_max_rss": "102907904", "process_out_blocks": "0", "process_user_time": 0.605579}
[0m19:16:12.251154 [debug] [MainThread]: Command `dbt run` failed at 19:16:12.251112 after 0.05 seconds
[0m19:16:12.251312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ba930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ba810>]}
[0m19:16:12.251475 [debug] [MainThread]: Flushing usage events
[0m19:16:13.877404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:05.013321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108818fb0>]}


============================== 19:17:05.017291 | bb807673-aab1-4cab-9aaa-3e0a38d49060 ==============================
[0m19:17:05.017291 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:17:05.017604 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'empty': 'False', 'static_parser': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'target_path': 'None'}
[0m19:17:05.019279 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce'
[0m19:17:05.020282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04134504, "process_in_blocks": "0", "process_kernel_time": 0.096601, "process_mem_max_rss": "103301120", "process_out_blocks": "0", "process_user_time": 0.606808}
[0m19:17:05.020508 [debug] [MainThread]: Command `dbt run` failed at 19:17:05.020466 after 0.04 seconds
[0m19:17:05.020668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108799df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108818f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881b050>]}
[0m19:17:05.020823 [debug] [MainThread]: Flushing usage events
[0m19:17:05.497025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:06.240761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253cf20>]}


============================== 19:32:06.246615 | 3fa91c91-18c7-4628-839c-9f0ebfbaadc6 ==============================
[0m19:32:06.246615 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:32:06.246937 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/Users/jaypatel/.dbt', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m19:32:07.138087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150d3a0>]}
[0m19:32:07.164577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11221ffb0>]}
[0m19:32:07.165165 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:32:07.278352 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:32:07.278829 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:32:07.279021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120089910>]}
[0m19:32:07.760651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b92450>]}
[0m19:32:07.792416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:32:07.793823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:32:07.808130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12042c170>]}
[0m19:32:07.808386 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:32:07.808565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa91c91-18c7-4628-839c-9f0ebfbaadc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bcd40>]}
[0m19:32:07.809242 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:32:07.809510 [debug] [MainThread]: Command end result
[0m19:32:07.818629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:32:07.819404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:32:07.821026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:32:07.822852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6235987, "process_in_blocks": "0", "process_kernel_time": 0.267667, "process_mem_max_rss": "173752320", "process_out_blocks": "0", "process_user_time": 1.459771}
[0m19:32:07.823176 [debug] [MainThread]: Command `dbt run` succeeded at 19:32:07.823127 after 1.62 seconds
[0m19:32:07.823373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200aa660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f83920>]}
[0m19:32:07.823541 [debug] [MainThread]: Flushing usage events
[0m19:32:08.385712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:51.276355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cd1f0>]}


============================== 19:35:51.282554 | 959ce2b9-e2b0-4c2d-ac16-1bec97ffea07 ==============================
[0m19:35:51.282554 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:35:51.282876 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m19:35:52.105421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e570>]}
[0m19:35:52.133046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d69c0>]}
[0m19:35:52.135003 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:35:52.220931 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:35:52.300356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m19:35:52.300656 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m19:35:52.300842 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m19:35:52.301009 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_shipments.sql
[0m19:35:52.301171 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stag_customer.sql
[0m19:35:52.418223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc80e0>]}
[0m19:35:52.445128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:35:52.452634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:35:52.470288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a0140>]}
[0m19:35:52.470509 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:35:52.470673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978d250>]}
[0m19:35:52.471482 [info ] [MainThread]: 
[0m19:35:52.471651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:52.471776 [info ] [MainThread]: 
[0m19:35:52.471997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:52.473997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:35:52.555822 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:35:52.556035 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:35:52.556167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:57.975152 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.419 seconds
[0m19:35:57.981504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:35:57.992170 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:35:57.992469 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:35:58.148748 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.156 seconds
[0m19:35:58.151852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b55ca0>]}
[0m19:35:58.157912 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:35:58.159164 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:35:58.159830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:35:58.160309 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:35:58.167391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:35:58.168928 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:35:58.185741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:35:58.186674 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:35:58.186870 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:35:58.296660 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9663-0307-1068-0000-00049d8a2759
[0m19:35:58.297022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 144 unexpected ';'.
[0m19:35:58.302691 [debug] [Thread-1 (]: Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:35:58.305023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb8eb40>]}
[0m19:35:58.305447 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stag_customer ................... [[31mERROR[0m in 0.14s]
[0m19:35:58.305777 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:35:58.305999 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:35:58.306287 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stag_customer' to be skipped because of status 'error'.  Reason: Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql.
[0m19:35:58.306581 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:35:58.307258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:35:58.307467 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:35:58.308650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:35:58.309034 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:35:58.310355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:35:58.310840 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:35:58.311048 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:35:58.401304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9663-0307-1068-0000-00049d8a275d
[0m19:35:58.401597 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 141 unexpected ';'.
[0m19:35:58.403701 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:35:58.403982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec27560>]}
[0m19:35:58.404346 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model analytics.stg_orders ...................... [[31mERROR[0m in 0.10s]
[0m19:35:58.404653 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:35:58.404859 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:35:58.405087 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:35:58.405356 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql.
[0m19:35:58.405612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:35:58.405891 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:35:58.406919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:35:58.407317 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:35:58.408683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:35:58.409298 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:35:58.409480 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:35:58.667887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9663-0307-1068-0000-00049d8a2761
[0m19:35:58.668666 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 144 unexpected ';'.
[0m19:35:58.673243 [debug] [Thread-1 (]: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:35:58.677536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ce2b9-e2b0-4c2d-ac16-1bec97ffea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec43fe0>]}
[0m19:35:58.678707 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model analytics.stg_shipments ................... [[31mERROR[0m in 0.27s]
[0m19:35:58.679390 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:35:58.680006 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_shipments' to be skipped because of status 'error'.  Reason: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql.
[0m19:35:58.680865 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:35:58.681423 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.order_status .................................... [[33mSKIP[0m]
[0m19:35:58.681913 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:35:58.682660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:58.682860 [debug] [MainThread]: Connection 'model.dbt_ecommerce.stg_shipments' was left open.
[0m19:35:58.683027 [debug] [MainThread]: On model.dbt_ecommerce.stg_shipments: Close
[0m19:35:58.815731 [info ] [MainThread]: 
[0m19:35:58.816191 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m19:35:58.816768 [debug] [MainThread]: Command end result
[0m19:35:58.830940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:35:58.832178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:35:58.839500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:35:58.839697 [info ] [MainThread]: 
[0m19:35:58.839883 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:35:58.840034 [info ] [MainThread]: 
[0m19:35:58.840208 [error] [MainThread]: [31mFailure in model stag_customer (models/staging/stag_customer.sql)[0m
[0m19:35:58.840375 [error] [MainThread]:   Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:35:58.840499 [info ] [MainThread]: 
[0m19:35:58.840642 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:35:58.840794 [info ] [MainThread]: 
[0m19:35:58.840997 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m19:35:58.841214 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:35:58.841385 [info ] [MainThread]: 
[0m19:35:58.841550 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:35:58.841680 [info ] [MainThread]: 
[0m19:35:58.841828 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m19:35:58.841980 [error] [MainThread]:   Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:35:58.842099 [info ] [MainThread]: 
[0m19:35:58.842236 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:35:58.842351 [info ] [MainThread]: 
[0m19:35:58.842504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 NO-OP=0 TOTAL=4
[0m19:35:58.847555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.637854, "process_in_blocks": "0", "process_kernel_time": 0.430271, "process_mem_max_rss": "197492736", "process_out_blocks": "0", "process_user_time": 1.551569}
[0m19:35:58.847887 [debug] [MainThread]: Command `dbt run` failed at 19:35:58.847836 after 7.64 seconds
[0m19:35:58.848464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109413fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c46960>]}
[0m19:35:58.848874 [debug] [MainThread]: Flushing usage events
[0m19:35:59.370268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:26.247654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078055b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107805310>]}


============================== 19:37:26.261118 | 6fea9b21-1b53-4c24-bf18-8adf4352c4cc ==============================
[0m19:37:26.261118 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:37:26.261502 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/jaypatel/.dbt', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run'}
[0m19:37:27.100783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6fc620>]}
[0m19:37:27.127482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106861100>]}
[0m19:37:27.129481 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:37:27.208949 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:37:27.307889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:27.308181 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m19:37:27.415336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82bb30>]}
[0m19:37:27.438974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:37:27.442914 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:37:27.470743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb6120>]}
[0m19:37:27.470963 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:37:27.471131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baae9c0>]}
[0m19:37:27.471918 [info ] [MainThread]: 
[0m19:37:27.472096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:27.472228 [info ] [MainThread]: 
[0m19:37:27.472450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:37:27.474443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:37:27.506779 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:37:27.507006 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:37:27.507152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:30.194067 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.687 seconds
[0m19:37:30.197617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:37:30.207025 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:37:30.207277 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:37:30.311782 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.104 seconds
[0m19:37:30.317933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d9730>]}
[0m19:37:30.324197 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:37:30.324869 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:37:30.325407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:37:30.325872 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:37:30.329402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:37:30.329896 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:37:30.351848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:37:30.352502 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:37:30.352691 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:37:30.444376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9665-0307-1068-0000-00049d8a276d
[0m19:37:30.444668 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 144 unexpected ';'.
[0m19:37:30.447790 [debug] [Thread-1 (]: Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:37:30.449003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a25f10>]}
[0m19:37:30.449371 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stag_customer ................... [[31mERROR[0m in 0.12s]
[0m19:37:30.449827 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:37:30.450204 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:37:30.450636 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stag_customer' to be skipped because of status 'error'.  Reason: Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql.
[0m19:37:30.450881 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:37:30.451456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:37:30.451629 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:37:30.452655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:37:30.452984 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:37:30.454270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:37:30.454682 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:37:30.454862 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:37:30.565554 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9665-0307-11cd-0000-00049d8a430d
[0m19:37:30.566272 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 141 unexpected ';'.
[0m19:37:30.571555 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:37:30.572313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b02a80>]}
[0m19:37:30.573274 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model analytics.stg_orders ...................... [[31mERROR[0m in 0.12s]
[0m19:37:30.574068 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:37:30.574580 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:37:30.575246 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql.
[0m19:37:30.575867 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:37:30.576526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:37:30.576935 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:37:30.578772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:37:30.579188 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:37:30.580575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:37:30.581315 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:37:30.581552 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:37:30.699795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9665-0307-129d-0000-00049d8a335d
[0m19:37:30.700512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 144 unexpected ';'.
[0m19:37:30.705858 [debug] [Thread-1 (]: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:37:30.706617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fea9b21-1b53-4c24-bf18-8adf4352c4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1eea0>]}
[0m19:37:30.707496 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model analytics.stg_shipments ................... [[31mERROR[0m in 0.13s]
[0m19:37:30.708248 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:37:30.709039 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_shipments' to be skipped because of status 'error'.  Reason: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql.
[0m19:37:30.709938 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:37:30.710511 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.order_status .................................... [[33mSKIP[0m]
[0m19:37:30.711046 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:37:30.711796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:30.711986 [debug] [MainThread]: Connection 'model.dbt_ecommerce.stg_shipments' was left open.
[0m19:37:30.712133 [debug] [MainThread]: On model.dbt_ecommerce.stg_shipments: Close
[0m19:37:30.831377 [info ] [MainThread]: 
[0m19:37:30.832109 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m19:37:30.833495 [debug] [MainThread]: Command end result
[0m19:37:30.849324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:37:30.850394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:37:30.854522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:37:30.854700 [info ] [MainThread]: 
[0m19:37:30.854887 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:37:30.855039 [info ] [MainThread]: 
[0m19:37:30.855341 [error] [MainThread]: [31mFailure in model stag_customer (models/staging/stag_customer.sql)[0m
[0m19:37:30.855645 [error] [MainThread]:   Database Error in model stag_customer (models/staging/stag_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:37:30.855868 [info ] [MainThread]: 
[0m19:37:30.856135 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stag_customer.sql
[0m19:37:30.856354 [info ] [MainThread]: 
[0m19:37:30.856617 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m19:37:30.856770 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 141 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:37:30.856885 [info ] [MainThread]: 
[0m19:37:30.857025 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_orders.sql
[0m19:37:30.857144 [info ] [MainThread]: 
[0m19:37:30.857387 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m19:37:30.857537 [error] [MainThread]:   Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 144 unexpected ';'.
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:37:30.857654 [info ] [MainThread]: 
[0m19:37:30.857790 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_shipments.sql
[0m19:37:30.857904 [info ] [MainThread]: 
[0m19:37:30.858048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 NO-OP=0 TOTAL=4
[0m19:37:30.859321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6689262, "process_in_blocks": "0", "process_kernel_time": 0.297609, "process_mem_max_rss": "199278592", "process_out_blocks": "0", "process_user_time": 1.434039}
[0m19:37:30.859731 [debug] [MainThread]: Command `dbt run` failed at 19:37:30.859660 after 4.67 seconds
[0m19:37:30.860064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107804e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc92f60>]}
[0m19:37:30.860351 [debug] [MainThread]: Flushing usage events
[0m19:37:31.437930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:25.876723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060be5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e49460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e491c0>]}


============================== 19:39:25.880642 | c785d555-5451-491a-b8a6-1062ad2cfff0 ==============================
[0m19:39:25.880642 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:39:25.880945 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'printer_width': '80', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m19:39:26.384645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95a600>]}
[0m19:39:26.411550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bc440>]}
[0m19:39:26.412202 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:39:26.492217 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:39:26.550860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:39:26.551162 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m19:39:26.551337 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_shipments.sql
[0m19:39:26.551491 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stag_customer.sql
[0m19:39:26.659344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b85c0>]}
[0m19:39:26.683333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:39:26.684858 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:39:26.698170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed6150>]}
[0m19:39:26.698396 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:39:26.698559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af57c80>]}
[0m19:39:26.699346 [info ] [MainThread]: 
[0m19:39:26.699512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:26.699635 [info ] [MainThread]: 
[0m19:39:26.699853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:26.701889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:39:26.735804 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:39:26.736009 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:39:26.736139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:27.804279 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.068 seconds
[0m19:39:27.810484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:39:27.827491 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:39:27.828037 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:39:27.951600 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.123 seconds
[0m19:39:27.954096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af55c40>]}
[0m19:39:27.955894 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:39:27.956235 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:39:27.956495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:39:27.956696 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:39:27.960452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:39:27.960872 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:39:27.976939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:39:27.977500 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:39:27.977696 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:39:28.896827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.918 seconds
[0m19:39:28.925106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490f0b0>]}
[0m19:39:28.925805 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.97s]
[0m19:39:28.926301 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:39:28.926625 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:39:28.927076 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:39:28.927510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:39:28.927807 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:39:28.929510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:39:28.930124 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:39:28.932047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:39:28.932702 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:39:28.932965 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:39:29.278523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m19:39:29.283450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee24380>]}
[0m19:39:29.284642 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.36s]
[0m19:39:29.285975 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:39:29.286746 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:39:29.287603 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:39:29.288291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:39:29.288735 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:39:29.291778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:39:29.292996 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:39:29.296564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:39:29.297606 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:39:29.298410 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:39:29.817414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m19:39:29.822371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eee27e0>]}
[0m19:39:29.823534 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.53s]
[0m19:39:29.824345 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:39:29.825434 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:39:29.826132 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m19:39:29.826941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m19:39:29.827517 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m19:39:29.832232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m19:39:29.833542 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m19:39:29.839119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m19:39:29.840825 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m19:39:29.841190 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.orders_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.orders_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m19:39:30.643024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9667-0307-129d-0000-00049d8a336d
[0m19:39:30.643811 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDERS_ID'
[0m19:39:30.649805 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:39:30.650553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c785d555-5451-491a-b8a6-1062ad2cfff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeec680>]}
[0m19:39:30.651343 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.82s]
[0m19:39:30.652027 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:39:30.652597 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m19:39:30.654354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:30.654681 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m19:39:30.654961 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m19:39:30.783633 [info ] [MainThread]: 
[0m19:39:30.784655 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m19:39:30.786367 [debug] [MainThread]: Command end result
[0m19:39:30.809336 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:39:30.810976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:39:30.816698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:39:30.816978 [info ] [MainThread]: 
[0m19:39:30.817241 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:30.817460 [info ] [MainThread]: 
[0m19:39:30.817724 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m19:39:30.817955 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:39:30.818133 [info ] [MainThread]: 
[0m19:39:30.818335 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m19:39:30.818506 [info ] [MainThread]: 
[0m19:39:30.818710 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m19:39:30.820249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9803834, "process_in_blocks": "0", "process_kernel_time": 0.288272, "process_mem_max_rss": "198639616", "process_out_blocks": "0", "process_user_time": 1.473699}
[0m19:39:30.820534 [debug] [MainThread]: Command `dbt run` failed at 19:39:30.820479 after 4.98 seconds
[0m19:39:30.820764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e49310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed40b0>]}
[0m19:39:30.820987 [debug] [MainThread]: Flushing usage events
[0m19:39:31.328445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:17.845649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303cbf0>]}


============================== 19:42:17.854431 | 354611e9-2487-407f-af40-89ce826bd208 ==============================
[0m19:42:17.854431 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:42:17.854813 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m19:42:18.799155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f27aa0>]}
[0m19:42:18.829747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e0cf20>]}
[0m19:42:18.831782 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:42:18.944995 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:42:19.036458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:19.036760 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m19:42:19.148462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207ff350>]}
[0m19:42:19.175882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:42:19.183179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:42:19.205171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12012b5f0>]}
[0m19:42:19.205439 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:42:19.205612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120704140>]}
[0m19:42:19.206474 [info ] [MainThread]: 
[0m19:42:19.206653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:19.206781 [info ] [MainThread]: 
[0m19:42:19.207021 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:42:19.209191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:42:19.274881 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:42:19.275119 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:42:19.275882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:22.406507 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.130 seconds
[0m19:42:22.411576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:42:22.424009 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:42:22.424307 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:42:22.599373 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.175 seconds
[0m19:42:22.607071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120704140>]}
[0m19:42:22.614669 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:42:22.615019 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:42:22.615285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:42:22.615455 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:42:22.619864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:42:22.620311 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:42:22.637603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:42:22.638168 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:42:22.638356 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:42:22.975942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m19:42:22.989856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f26ba0>]}
[0m19:42:22.990247 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.37s]
[0m19:42:22.990692 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:42:22.991035 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:42:22.991379 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:42:22.991625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:42:22.991799 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:42:22.992668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:42:22.993129 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:42:22.994542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:42:22.994980 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:42:22.995164 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:42:23.385624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m19:42:23.387138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215ba3f0>]}
[0m19:42:23.387541 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.40s]
[0m19:42:23.387826 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:42:23.388023 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:42:23.388314 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:42:23.388587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:42:23.388768 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:42:23.389766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:42:23.390179 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:42:23.391438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:42:23.391854 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:42:23.392021 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:42:23.683290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m19:42:23.685292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215d7020>]}
[0m19:42:23.685729 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.30s]
[0m19:42:23.686105 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:42:23.686621 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:42:23.687005 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m19:42:23.687347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m19:42:23.687595 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m19:42:23.689371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m19:42:23.689766 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m19:42:23.691758 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m19:42:23.692524 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m19:42:23.692733 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.orders_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.orders_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m19:42:24.013222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be966a-0307-1068-0000-00049d8a27a5
[0m19:42:24.013508 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDERS_ID'
[0m19:42:24.017704 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:42:24.018018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '354611e9-2487-407f-af40-89ce826bd208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215da9f0>]}
[0m19:42:24.018354 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.33s]
[0m19:42:24.018628 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:42:24.018864 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m19:42:24.019715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:24.019860 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m19:42:24.019997 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m19:42:24.177567 [info ] [MainThread]: 
[0m19:42:24.177890 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m19:42:24.178532 [debug] [MainThread]: Command end result
[0m19:42:24.188909 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:42:24.189898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:42:24.198105 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:42:24.198290 [info ] [MainThread]: 
[0m19:42:24.198463 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:42:24.198604 [info ] [MainThread]: 
[0m19:42:24.198854 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m19:42:24.199118 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:42:24.199320 [info ] [MainThread]: 
[0m19:42:24.199471 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m19:42:24.199594 [info ] [MainThread]: 
[0m19:42:24.199746 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m19:42:24.203280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.422101, "process_in_blocks": "0", "process_kernel_time": 0.355515, "process_mem_max_rss": "200425472", "process_out_blocks": "0", "process_user_time": 1.49157}
[0m19:42:24.203669 [debug] [MainThread]: Command `dbt run` failed at 19:42:24.203599 after 6.42 seconds
[0m19:42:24.203964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f5b560>]}
[0m19:42:24.204240 [debug] [MainThread]: Flushing usage events
[0m19:42:24.823301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:04.556825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106368170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cd0d0>]}


============================== 19:48:04.560629 | c2cf7e70-0977-41a2-b143-7e55a44341b7 ==============================
[0m19:48:04.560629 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:48:04.560930 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m19:48:05.183278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73b6b0>]}
[0m19:48:05.210260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5c080>]}
[0m19:48:05.210866 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:48:05.292869 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:48:05.353567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:05.353772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:05.365311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b7500>]}
[0m19:48:05.390013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:48:05.392949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:48:05.405808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39de80>]}
[0m19:48:05.406025 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:48:05.406195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b247620>]}
[0m19:48:05.407030 [info ] [MainThread]: 
[0m19:48:05.407195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:05.407319 [info ] [MainThread]: 
[0m19:48:05.407534 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:48:05.409428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:48:05.444319 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:48:05.444530 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:48:05.444669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:08.816098 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.371 seconds
[0m19:48:08.821438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:48:08.843107 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:48:08.843572 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:48:09.062874 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.219 seconds
[0m19:48:09.067975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5d790>]}
[0m19:48:09.072170 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:48:09.072883 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:48:09.073770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:48:09.074223 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:48:09.081135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:48:09.081918 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:48:09.105386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:48:09.106048 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:48:09.106283 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:48:09.503902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m19:48:09.525868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498af90>]}
[0m19:48:09.526426 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.45s]
[0m19:48:09.526840 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:48:09.527113 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:48:09.527494 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:48:09.527819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:48:09.528065 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:48:09.529330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:48:09.529772 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:48:09.531442 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:48:09.532052 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:48:09.532349 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:48:09.878423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m19:48:09.883710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11826cdd0>]}
[0m19:48:09.884611 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.36s]
[0m19:48:09.885318 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:48:09.885800 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:48:09.886513 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:48:09.887107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:48:09.887545 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:48:09.889388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:48:09.890125 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:48:09.892939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:48:09.893843 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:48:09.894208 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:48:10.838074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m19:48:10.843969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184494f0>]}
[0m19:48:10.845219 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m19:48:10.846233 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:48:10.847537 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:48:10.848188 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m19:48:10.848760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m19:48:10.849354 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m19:48:10.854510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m19:48:10.855559 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m19:48:10.861178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m19:48:10.862796 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m19:48:10.863175 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.orders_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.orders_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m19:48:11.314017 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9670-0307-11cd-0000-00049d8a4385
[0m19:48:11.314346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDERS_ID'
[0m19:48:11.316758 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:48:11.317039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2cf7e70-0977-41a2-b143-7e55a44341b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92fc0>]}
[0m19:48:11.317373 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.47s]
[0m19:48:11.317647 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:48:11.317902 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m19:48:11.318732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:11.318877 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m19:48:11.319004 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m19:48:11.482406 [info ] [MainThread]: 
[0m19:48:11.483001 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m19:48:11.484346 [debug] [MainThread]: Command end result
[0m19:48:11.504278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:48:11.505755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:48:11.510428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:48:11.510647 [info ] [MainThread]: 
[0m19:48:11.510869 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:48:11.511067 [info ] [MainThread]: 
[0m19:48:11.511301 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m19:48:11.511556 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:48:11.511750 [info ] [MainThread]: 
[0m19:48:11.511951 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m19:48:11.512124 [info ] [MainThread]: 
[0m19:48:11.512322 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m19:48:11.514585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.997945, "process_in_blocks": "0", "process_kernel_time": 0.344292, "process_mem_max_rss": "193019904", "process_out_blocks": "0", "process_user_time": 1.46545}
[0m19:48:11.514930 [debug] [MainThread]: Command `dbt run` failed at 19:48:11.514869 after 7.00 seconds
[0m19:48:11.515195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106368170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af06cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af06cf0>]}
[0m19:48:11.515431 [debug] [MainThread]: Flushing usage events
[0m19:48:12.100610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:30.151130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d0d0>]}


============================== 19:49:30.156129 | a7017cac-6890-418d-8b3d-1f9f658abaf2 ==============================
[0m19:49:30.156129 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:49:30.156591 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'no_print': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:49:31.078470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ee570>]}
[0m19:49:31.128199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707fe30>]}
[0m19:49:31.129164 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:49:31.239911 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:49:31.349957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:31.350475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:31.371506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065963f0>]}
[0m19:49:31.417524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:49:31.423299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:49:31.479055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170f4e00>]}
[0m19:49:31.479418 [info ] [MainThread]: Found 4 models, 477 macros
[0m19:49:31.479627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065962d0>]}
[0m19:49:31.480501 [info ] [MainThread]: 
[0m19:49:31.480677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:49:31.480804 [info ] [MainThread]: 
[0m19:49:31.481063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:49:31.483075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m19:49:31.528915 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m19:49:31.529177 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m19:49:31.529329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:34.190286 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.661 seconds
[0m19:49:34.194057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m19:49:34.206930 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m19:49:34.207180 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m19:49:34.370044 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.163 seconds
[0m19:49:34.371952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f9af0>]}
[0m19:49:34.377096 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m19:49:34.377450 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m19:49:34.378063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m19:49:34.378270 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m19:49:34.381717 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m19:49:34.382122 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m19:49:34.401070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m19:49:34.401725 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m19:49:34.401940 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select * FROM raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m19:49:34.636612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m19:49:34.664609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104627470>]}
[0m19:49:34.665220 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.28s]
[0m19:49:34.665555 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m19:49:34.665780 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m19:49:34.666088 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m19:49:34.666720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m19:49:34.666944 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m19:49:34.669195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m19:49:34.669756 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m19:49:34.671139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m19:49:34.671567 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m19:49:34.673020 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select * FROM raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m19:49:35.010398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m19:49:35.012820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12016a1b0>]}
[0m19:49:35.013392 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.35s]
[0m19:49:35.013829 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m19:49:35.014137 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m19:49:35.014644 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m19:49:35.015060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m19:49:35.015341 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m19:49:35.016671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m19:49:35.017226 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m19:49:35.019178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m19:49:35.019775 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m19:49:35.020012 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select * FROM raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m19:49:35.317542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m19:49:35.321629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12024a030>]}
[0m19:49:35.323182 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m19:49:35.324600 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m19:49:35.325842 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m19:49:35.326901 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m19:49:35.327536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m19:49:35.328007 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m19:49:35.332338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m19:49:35.335870 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m19:49:35.338186 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m19:49:35.338973 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m19:49:35.339175 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.orders_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.orders_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m19:49:35.623025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9671-0307-129d-0000-00049d8a3499
[0m19:49:35.623305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDERS_ID'
[0m19:49:35.626435 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:49:35.626703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7017cac-6890-418d-8b3d-1f9f658abaf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043094f0>]}
[0m19:49:35.627033 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.30s]
[0m19:49:35.627307 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m19:49:35.627574 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m19:49:35.628770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:35.629037 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m19:49:35.629183 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m19:49:35.736111 [info ] [MainThread]: 
[0m19:49:35.736450 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m19:49:35.737347 [debug] [MainThread]: Command end result
[0m19:49:35.749735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m19:49:35.750916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m19:49:35.755042 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m19:49:35.755217 [info ] [MainThread]: 
[0m19:49:35.755398 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:49:35.755633 [info ] [MainThread]: 
[0m19:49:35.755882 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m19:49:35.756269 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m19:49:35.756520 [info ] [MainThread]: 
[0m19:49:35.756743 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m19:49:35.756899 [info ] [MainThread]: 
[0m19:49:35.757089 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m19:49:35.762318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6839848, "process_in_blocks": "0", "process_kernel_time": 0.396223, "process_mem_max_rss": "187498496", "process_out_blocks": "0", "process_user_time": 1.429709}
[0m19:49:35.762580 [debug] [MainThread]: Command `dbt run` failed at 19:49:35.762534 after 5.68 seconds
[0m19:49:35.762786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156c3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156c3fe0>]}
[0m19:49:35.762985 [debug] [MainThread]: Flushing usage events
[0m19:49:36.271389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:45.423140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105499280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105498fe0>]}


============================== 20:23:45.434811 | 3399169b-6085-45ca-9338-a3d7ad0b2a31 ==============================
[0m20:23:45.434811 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:23:45.435130 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'indirect_selection': 'eager'}
[0m20:23:46.299694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd3d40>]}
[0m20:23:46.329399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a04cb0>]}
[0m20:23:46.331774 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:23:46.442048 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:23:46.558804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:23:46.559144 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stag_customer.sql
[0m20:23:46.559332 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m20:23:46.559501 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_shipments.sql
[0m20:23:46.676351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a6270>]}
[0m20:23:46.700065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:23:46.704779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:23:46.720810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ebd40>]}
[0m20:23:46.721042 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:23:46.721212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fddc0>]}
[0m20:23:46.721968 [info ] [MainThread]: 
[0m20:23:46.722148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:46.722281 [info ] [MainThread]: 
[0m20:23:46.722500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:46.724409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:23:46.773764 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:23:46.773989 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:23:46.774145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:50.043496 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.269 seconds
[0m20:23:50.049794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:23:50.067102 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:23:50.067598 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:23:50.246254 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.178 seconds
[0m20:23:50.252819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f3410>]}
[0m20:23:50.258357 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:23:50.259141 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:23:50.259734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:23:50.260167 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:23:50.266098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:23:50.266843 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:23:50.285039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:23:50.285730 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:23:50.285948 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:23:50.439170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9693-0307-129d-0000-00049d8a34d5
[0m20:23:50.439527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'CUSTOMER_ID'
[0m20:23:50.448829 [debug] [Thread-1 (]: Database Error in model stag_customer (models/staging/stag_customer.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'CUSTOMER_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m20:23:50.451737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104737380>]}
[0m20:23:50.452194 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics.stag_customer ................... [[31mERROR[0m in 0.19s]
[0m20:23:50.452647 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:23:50.452976 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:23:50.453406 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stag_customer' to be skipped because of status 'error'.  Reason: Database Error in model stag_customer (models/staging/stag_customer.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'CUSTOMER_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql.
[0m20:23:50.453842 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:23:50.454722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:23:50.454996 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:23:50.456476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:23:50.457029 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:23:50.459046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:23:50.459778 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:23:50.460051 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    orders_id as orders_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:23:50.828913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9693-0307-11cd-0000-00049d8a4481
[0m20:23:50.829890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ORDERS_ID'
[0m20:23:50.834894 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:23:50.835589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e72c4d0>]}
[0m20:23:50.836419 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model analytics.stg_orders ...................... [[31mERROR[0m in 0.38s]
[0m20:23:50.837099 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:23:50.837589 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:23:50.838030 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql.
[0m20:23:50.838422 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:23:50.838986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:23:50.839446 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:23:50.841459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:23:50.842211 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:23:50.844811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:23:50.845733 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:23:50.846057 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    orders_id as orders_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:23:50.999576 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be9693-0307-1068-0000-00049d8a2891
[0m20:23:50.999903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ORDERS_ID'
[0m20:23:51.002135 [debug] [Thread-1 (]: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:23:51.002424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3399169b-6085-45ca-9338-a3d7ad0b2a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f4dd0>]}
[0m20:23:51.002791 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model analytics.stg_shipments ................... [[31mERROR[0m in 0.16s]
[0m20:23:51.003101 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:23:51.003360 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_shipments' to be skipped because of status 'error'.  Reason: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql.
[0m20:23:51.003743 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:23:51.004124 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.order_status .................................... [[33mSKIP[0m]
[0m20:23:51.004413 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:23:51.004977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:51.005153 [debug] [MainThread]: Connection 'model.dbt_ecommerce.stg_shipments' was left open.
[0m20:23:51.005309 [debug] [MainThread]: On model.dbt_ecommerce.stg_shipments: Close
[0m20:23:51.153879 [info ] [MainThread]: 
[0m20:23:51.154503 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m20:23:51.155693 [debug] [MainThread]: Command end result
[0m20:23:51.176957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:23:51.178374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:23:51.183238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:23:51.183481 [info ] [MainThread]: 
[0m20:23:51.183725 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:23:51.183928 [info ] [MainThread]: 
[0m20:23:51.184163 [error] [MainThread]: [31mFailure in model stag_customer (models/staging/stag_customer.sql)[0m
[0m20:23:51.184397 [error] [MainThread]:   Database Error in model stag_customer (models/staging/stag_customer.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'CUSTOMER_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stag_customer.sql
[0m20:23:51.184579 [info ] [MainThread]: 
[0m20:23:51.184785 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stag_customer.sql
[0m20:23:51.184958 [info ] [MainThread]: 
[0m20:23:51.185169 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m20:23:51.185383 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:23:51.185554 [info ] [MainThread]: 
[0m20:23:51.185751 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:23:51.185920 [info ] [MainThread]: 
[0m20:23:51.186129 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m20:23:51.186357 [error] [MainThread]:   Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:23:51.186525 [info ] [MainThread]: 
[0m20:23:51.186721 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:23:51.186882 [info ] [MainThread]: 
[0m20:23:51.187086 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 NO-OP=0 TOTAL=4
[0m20:23:51.189623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.833157, "process_in_blocks": "0", "process_kernel_time": 0.338521, "process_mem_max_rss": "197001216", "process_out_blocks": "0", "process_user_time": 1.482627}
[0m20:23:51.189972 [debug] [MainThread]: Command `dbt run` failed at 20:23:51.189914 after 5.83 seconds
[0m20:23:51.190283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105499220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104737380>]}
[0m20:23:51.190564 [debug] [MainThread]: Flushing usage events
[0m20:23:52.484401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:20.565539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53ce00>]}


============================== 20:34:20.569987 | ef67398c-4b02-41f3-9106-56a192acd847 ==============================
[0m20:34:20.569987 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:34:20.570326 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False'}
[0m20:34:21.428789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953a5a0>]}
[0m20:34:21.456490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109591bb0>]}
[0m20:34:21.460853 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:34:21.564863 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:34:21.667939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:21.668167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:21.679876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feb1af0>]}
[0m20:34:21.709794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:34:21.715056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:34:21.762855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a99790>]}
[0m20:34:21.763080 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:34:21.763263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10face0c0>]}
[0m20:34:21.764064 [info ] [MainThread]: 
[0m20:34:21.764240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:34:21.764370 [info ] [MainThread]: 
[0m20:34:21.764604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:34:21.766562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:34:21.813766 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:34:21.813971 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:34:21.814101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:26.690741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.876 seconds
[0m20:34:26.695900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:34:26.715801 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:34:26.716242 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:34:26.861566 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.145 seconds
[0m20:34:26.867589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118945820>]}
[0m20:34:26.876042 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:34:26.876760 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:34:26.877847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:34:26.878284 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:34:26.886200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:34:26.886982 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:34:26.914358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:34:26.915137 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:34:26.915396 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:34:27.262270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m20:34:27.291494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076270b0>]}
[0m20:34:27.291919 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.41s]
[0m20:34:27.292340 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:34:27.292675 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:34:27.293131 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:34:27.293542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:34:27.293724 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:34:27.294700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:34:27.295245 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:34:27.296879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:34:27.297689 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:34:27.297939 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    orders_id as orders_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:34:27.431780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be969e-0307-1068-0000-00049d8a2921
[0m20:34:27.432049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ORDERS_ID'
[0m20:34:27.438068 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:34:27.438489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e4699a0>]}
[0m20:34:27.439044 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model analytics.stg_orders ...................... [[31mERROR[0m in 0.14s]
[0m20:34:27.439456 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:34:27.439728 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:34:27.440103 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql.
[0m20:34:27.440469 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:34:27.441398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:34:27.441685 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:34:27.443063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:34:27.443538 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:34:27.444889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:34:27.445367 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:34:27.445553 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    orders_id as orders_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:34:27.571434 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be969e-0307-129d-0000-00049d8a3529
[0m20:34:27.572135 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ORDERS_ID'
[0m20:34:27.575349 [debug] [Thread-1 (]: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:34:27.575650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef67398c-4b02-41f3-9106-56a192acd847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5d3aa0>]}
[0m20:34:27.575984 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model analytics.stg_shipments ................... [[31mERROR[0m in 0.13s]
[0m20:34:27.576465 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:34:27.577002 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.stg_shipments' to be skipped because of status 'error'.  Reason: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql.
[0m20:34:27.577691 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:34:27.578333 [info ] [Thread-1 (]: 4 of 4 SKIP relation analytics.order_status .................................... [[33mSKIP[0m]
[0m20:34:27.578987 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:34:27.580071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:27.580452 [debug] [MainThread]: Connection 'model.dbt_ecommerce.stg_shipments' was left open.
[0m20:34:27.580783 [debug] [MainThread]: On model.dbt_ecommerce.stg_shipments: Close
[0m20:34:27.685670 [info ] [MainThread]: 
[0m20:34:27.686015 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m20:34:27.686667 [debug] [MainThread]: Command end result
[0m20:34:27.747911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:34:27.748852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:34:27.752441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:34:27.752605 [info ] [MainThread]: 
[0m20:34:27.752789 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:34:27.752938 [info ] [MainThread]: 
[0m20:34:27.753117 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m20:34:27.753286 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:34:27.753413 [info ] [MainThread]: 
[0m20:34:27.753561 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_orders.sql
[0m20:34:27.753690 [info ] [MainThread]: 
[0m20:34:27.753848 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m20:34:27.754011 [error] [MainThread]:   Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS_ID'
  compiled code at target/run/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:34:27.754144 [info ] [MainThread]: 
[0m20:34:27.754302 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/staging/stg_shipments.sql
[0m20:34:27.754426 [info ] [MainThread]: 
[0m20:34:27.754572 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=4
[0m20:34:27.760074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2442794, "process_in_blocks": "0", "process_kernel_time": 0.344564, "process_mem_max_rss": "197279744", "process_out_blocks": "0", "process_user_time": 1.373233}
[0m20:34:27.760314 [debug] [MainThread]: Command `dbt run` failed at 20:34:27.760270 after 7.24 seconds
[0m20:34:27.760486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cdf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cddeb0>]}
[0m20:34:27.760642 [debug] [MainThread]: Flushing usage events
[0m20:34:28.709487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:36.186571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105165190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105164f20>]}


============================== 20:36:36.196290 | 232080b1-afa5-4e39-b448-f3a21f974daf ==============================
[0m20:36:36.196290 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:36:36.196650 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/jaypatel/.dbt', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_format': 'default'}
[0m20:36:36.944225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104460bc0>]}
[0m20:36:36.971845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104862570>]}
[0m20:36:36.972381 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:36:37.052418 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:36:37.132204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:36:37.132502 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_shipments.sql
[0m20:36:37.132685 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m20:36:37.243018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109238560>]}
[0m20:36:37.270198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:36:37.275447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:36:37.327230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916d640>]}
[0m20:36:37.327476 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:36:37.327646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fc3b0>]}
[0m20:36:37.328427 [info ] [MainThread]: 
[0m20:36:37.328614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:37.328776 [info ] [MainThread]: 
[0m20:36:37.329037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:37.331255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:36:37.374399 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:36:37.374652 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:36:37.374889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:40.164793 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.790 seconds
[0m20:36:40.170269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:36:40.184500 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:36:40.184963 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:36:40.340154 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.155 seconds
[0m20:36:40.349553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0d100>]}
[0m20:36:40.352726 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:36:40.353143 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:36:40.353426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:36:40.353599 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:36:40.356826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:36:40.357416 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:36:40.372893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:36:40.373526 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:36:40.373724 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:36:40.832291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m20:36:40.865187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c26f90>]}
[0m20:36:40.865719 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.51s]
[0m20:36:40.866183 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:36:40.866522 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:36:40.866839 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:36:40.867197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:36:40.867484 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:36:40.868640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:36:40.869155 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:36:40.871194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:36:40.871889 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:36:40.872168 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as orders_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:36:41.549860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m20:36:41.554160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4aa630>]}
[0m20:36:41.555193 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.69s]
[0m20:36:41.556098 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:36:41.556795 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:36:41.557653 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:36:41.558221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:36:41.558619 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:36:41.561830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:36:41.562488 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:36:41.564447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:36:41.569248 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:36:41.569470 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:36:42.163702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m20:36:42.168170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d7050>]}
[0m20:36:42.169313 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m20:36:42.170217 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:36:42.171237 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:36:42.171899 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:36:42.172463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:36:42.172910 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:36:42.176476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:36:42.178924 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:36:42.183555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:36:42.184560 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:36:42.184743 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.orders_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.orders_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:36:42.888635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be96a0-0307-1068-0000-00049d8a2929
[0m20:36:42.889243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 12
invalid identifier 'C.NAME'
[0m20:36:42.894223 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:36:42.894604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232080b1-afa5-4e39-b448-f3a21f974daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4cbb90>]}
[0m20:36:42.894979 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.72s]
[0m20:36:42.895266 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:36:42.895778 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m20:36:42.897399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:42.897539 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:36:42.897668 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:36:43.293368 [info ] [MainThread]: 
[0m20:36:43.294394 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m20:36:43.295679 [debug] [MainThread]: Command end result
[0m20:36:43.310665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:36:43.311731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:36:43.317671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:36:43.317858 [info ] [MainThread]: 
[0m20:36:43.318046 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:36:43.318199 [info ] [MainThread]: 
[0m20:36:43.318497 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m20:36:43.318792 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:36:43.318941 [info ] [MainThread]: 
[0m20:36:43.319086 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m20:36:43.319206 [info ] [MainThread]: 
[0m20:36:43.319344 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m20:36:43.324994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1900716, "process_in_blocks": "0", "process_kernel_time": 0.312953, "process_mem_max_rss": "197902336", "process_out_blocks": "0", "process_user_time": 1.461443}
[0m20:36:43.325273 [debug] [MainThread]: Command `dbt run` failed at 20:36:43.325199 after 7.19 seconds
[0m20:36:43.325624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105165070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4a3b00>]}
[0m20:36:43.326057 [debug] [MainThread]: Flushing usage events
[0m20:36:43.832168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:14.440547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107621430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107621070>]}


============================== 20:37:14.444154 | 022748b0-d732-465a-ae55-26a6f217f1f5 ==============================
[0m20:37:14.444154 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:37:14.444491 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:37:15.043920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1f380>]}
[0m20:37:15.071181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b38bb60>]}
[0m20:37:15.071698 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:37:15.151823 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:37:15.210119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:15.210412 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:37:15.319025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba57050>]}
[0m20:37:15.343468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:37:15.347796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:37:15.359370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b983650>]}
[0m20:37:15.359593 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:37:15.359762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d6cc0>]}
[0m20:37:15.360556 [info ] [MainThread]: 
[0m20:37:15.360739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:15.360866 [info ] [MainThread]: 
[0m20:37:15.361078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:15.363062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:37:15.414431 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:37:15.414654 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:37:15.414804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:18.020298 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.605 seconds
[0m20:37:18.024514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:37:18.035450 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:37:18.035691 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:37:18.166034 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.130 seconds
[0m20:37:18.181898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4296a0>]}
[0m20:37:18.186155 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:37:18.187013 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:37:18.187716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:37:18.188172 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:37:18.195881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:37:18.196858 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:37:18.222174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:37:18.222907 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:37:18.223153 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:37:18.519090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m20:37:18.551820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edf350>]}
[0m20:37:18.552585 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.36s]
[0m20:37:18.553072 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:37:18.553377 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:37:18.553748 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:37:18.554070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:37:18.554308 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:37:18.555589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:37:18.556093 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:37:18.558007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:37:18.558594 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:37:18.558827 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as orders_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:37:18.824364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m20:37:18.832727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102f7a0>]}
[0m20:37:18.834595 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m20:37:18.835416 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:37:18.835952 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:37:18.836799 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:37:18.837501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:37:18.837975 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:37:18.840448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:37:18.841409 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:37:18.844654 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:37:18.845723 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:37:18.846133 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:37:19.233047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m20:37:19.237228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102d700>]}
[0m20:37:19.238320 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.40s]
[0m20:37:19.239211 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:37:19.240269 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:37:19.241095 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:37:19.241784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:37:19.242243 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:37:19.246338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:37:19.246852 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:37:19.249796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:37:19.250662 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:37:19.250896 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.orders_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:37:19.746882 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be96a1-0307-1068-0000-00049d8a2931
[0m20:37:19.747266 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDER_ID'
[0m20:37:19.750004 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:37:19.750330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022748b0-d732-465a-ae55-26a6f217f1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110cd460>]}
[0m20:37:19.750705 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.51s]
[0m20:37:19.751025 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:37:19.751599 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m20:37:19.752688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:19.752879 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:37:19.753043 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:37:19.884004 [info ] [MainThread]: 
[0m20:37:19.884815 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m20:37:19.885844 [debug] [MainThread]: Command end result
[0m20:37:19.912704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:37:19.914047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:37:19.922412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:37:19.922690 [info ] [MainThread]: 
[0m20:37:19.922905 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:37:19.923074 [info ] [MainThread]: 
[0m20:37:19.923271 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m20:37:19.923465 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:37:19.923611 [info ] [MainThread]: 
[0m20:37:19.923796 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m20:37:19.923951 [info ] [MainThread]: 
[0m20:37:19.924125 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m20:37:19.929129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5230722, "process_in_blocks": "0", "process_kernel_time": 0.269203, "process_mem_max_rss": "198148096", "process_out_blocks": "0", "process_user_time": 1.47974}
[0m20:37:19.929418 [debug] [MainThread]: Command `dbt run` failed at 20:37:19.929370 after 5.52 seconds
[0m20:37:19.929625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107621280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4db1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102ea50>]}
[0m20:37:19.929817 [debug] [MainThread]: Flushing usage events
[0m20:37:20.380346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:24.852240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863cf80>]}


============================== 20:38:24.855911 | 897b866d-484a-4a68-a12f-a6d4076db3bf ==============================
[0m20:38:24.855911 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:38:24.856208 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'introspect': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None'}
[0m20:38:25.358344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f0e0>]}
[0m20:38:25.384547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105890530>]}
[0m20:38:25.385105 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:38:25.461354 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:38:25.517677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:25.517962 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:38:25.615905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d257a10>]}
[0m20:38:25.639628 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:38:25.641182 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:38:25.653886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da28320>]}
[0m20:38:25.654107 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:38:25.654278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e68d0>]}
[0m20:38:25.655018 [info ] [MainThread]: 
[0m20:38:25.655201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:25.655332 [info ] [MainThread]: 
[0m20:38:25.655544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:38:25.657458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:38:25.684262 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:38:25.684467 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:38:25.684599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:28.340724 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.656 seconds
[0m20:38:28.345935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:38:28.361057 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:38:28.361470 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:38:28.483859 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.122 seconds
[0m20:38:28.493863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d849010>]}
[0m20:38:28.498187 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:38:28.498865 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:38:28.499427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:38:28.499856 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:38:28.507098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:38:28.508073 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:38:28.532344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:38:28.533247 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:38:28.533527 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:38:28.864758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m20:38:28.895697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea27fe0>]}
[0m20:38:28.896310 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.40s]
[0m20:38:28.896776 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:38:28.897091 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:38:28.897495 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:38:28.897830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:38:28.898082 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:38:28.899489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:38:28.899943 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:38:28.902023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:38:28.902742 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:38:28.903072 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as orders_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:38:29.289867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m20:38:29.294870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d511fd0>]}
[0m20:38:29.296139 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.40s]
[0m20:38:29.296959 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:38:29.297507 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:38:29.298211 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:38:29.298803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:38:29.299233 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:38:29.302031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:38:29.303059 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:38:29.306478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:38:29.307590 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:38:29.308023 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:38:29.583934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m20:38:29.588266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eabca10>]}
[0m20:38:29.589132 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.29s]
[0m20:38:29.589852 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:38:29.590794 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:38:29.591471 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:38:29.591985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:38:29.592402 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:38:29.596159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:38:29.596908 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:38:29.601536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:38:29.602985 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:38:29.603344 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:38:29.895546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be96a2-0307-1068-0000-00049d8a293d
[0m20:38:29.896439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 12
invalid identifier 'O.ORDER_ID'
[0m20:38:29.902786 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:38:29.903507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897b866d-484a-4a68-a12f-a6d4076db3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead50a0>]}
[0m20:38:29.904340 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.31s]
[0m20:38:29.905049 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:38:29.905704 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m20:38:29.907692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:29.908019 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:38:29.908303 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:38:30.022006 [info ] [MainThread]: 
[0m20:38:30.022605 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m20:38:30.023934 [debug] [MainThread]: Command end result
[0m20:38:30.044259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:38:30.045535 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:38:30.050401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:38:30.050652 [info ] [MainThread]: 
[0m20:38:30.050891 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:30.051090 [info ] [MainThread]: 
[0m20:38:30.051325 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m20:38:30.051551 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 8 at position 12
  invalid identifier 'O.ORDER_ID'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:38:30.051731 [info ] [MainThread]: 
[0m20:38:30.051936 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m20:38:30.052103 [info ] [MainThread]: 
[0m20:38:30.052302 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m20:38:30.053826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.236342, "process_in_blocks": "0", "process_kernel_time": 0.257286, "process_mem_max_rss": "196689920", "process_out_blocks": "0", "process_user_time": 1.4744}
[0m20:38:30.054107 [debug] [MainThread]: Command `dbt run` failed at 20:38:30.054054 after 5.24 seconds
[0m20:38:30.054335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaad640>]}
[0m20:38:30.054556 [debug] [MainThread]: Flushing usage events
[0m20:38:30.541777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:24.437762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8cfb0>]}


============================== 20:39:24.441592 | ac34d47b-45ba-43f9-b9b1-fe0925b09e37 ==============================
[0m20:39:24.441592 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:39:24.441936 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/Users/jaypatel/.dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m20:39:24.920414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd9610>]}
[0m20:39:24.945844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934c860>]}
[0m20:39:24.946360 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:39:25.024004 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:39:25.079408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:25.079702 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m20:39:25.180559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec2ea0>]}
[0m20:39:25.204307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:39:25.205672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:39:25.217113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad751c0>]}
[0m20:39:25.217350 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:39:25.217516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5c140>]}
[0m20:39:25.218295 [info ] [MainThread]: 
[0m20:39:25.218472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:25.218600 [info ] [MainThread]: 
[0m20:39:25.218817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:25.220759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:39:25.247950 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:39:25.248139 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:39:25.248267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:28.054480 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.806 seconds
[0m20:39:28.058566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:39:28.076388 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:39:28.076908 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:39:28.191474 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.114 seconds
[0m20:39:28.200885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6faa0>]}
[0m20:39:28.204685 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:39:28.205361 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:39:28.205834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:39:28.206195 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:39:28.212917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:39:28.213846 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:39:28.236855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:39:28.237605 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:39:28.237869 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:39:28.565775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m20:39:28.595922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5fd10>]}
[0m20:39:28.596502 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.39s]
[0m20:39:28.597055 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:39:28.597392 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:39:28.597826 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:39:28.598156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:39:28.598420 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:39:28.599722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:39:28.600416 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:39:28.602539 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:39:28.603296 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:39:28.603756 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as order_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:39:29.074136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m20:39:29.075409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a64e0>]}
[0m20:39:29.075752 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.48s]
[0m20:39:29.076020 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:39:29.076199 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:39:29.076460 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:39:29.076699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:39:29.076870 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:39:29.077746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:39:29.078072 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:39:29.079228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:39:29.079630 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:39:29.079797 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:39:29.325347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m20:39:29.330873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205c05f0>]}
[0m20:39:29.332148 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.25s]
[0m20:39:29.332967 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:39:29.334180 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:39:29.334938 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:39:29.335624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:39:29.336276 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:39:29.341093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:39:29.342282 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:39:29.348098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:39:29.349780 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:39:29.350231 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:39:29.778770 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be96a3-0307-11cd-0000-00049d8a4505
[0m20:39:29.779601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 12
invalid identifier 'C.NAME'
[0m20:39:29.785765 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:39:29.786301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac34d47b-45ba-43f9-b9b1-fe0925b09e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d89e0>]}
[0m20:39:29.786904 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.45s]
[0m20:39:29.787399 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:39:29.787942 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m20:39:29.789437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:29.789763 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:39:29.790031 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:39:29.904680 [info ] [MainThread]: 
[0m20:39:29.905915 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m20:39:29.907825 [debug] [MainThread]: Command end result
[0m20:39:29.939081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:39:29.940855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:39:29.946588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:39:29.946880 [info ] [MainThread]: 
[0m20:39:29.947165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:39:29.947405 [info ] [MainThread]: 
[0m20:39:29.947687 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m20:39:29.947958 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:39:29.948158 [info ] [MainThread]: 
[0m20:39:29.948392 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m20:39:29.948584 [info ] [MainThread]: 
[0m20:39:29.948819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m20:39:29.951012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5467153, "process_in_blocks": "0", "process_kernel_time": 0.255469, "process_mem_max_rss": "199524352", "process_out_blocks": "0", "process_user_time": 1.462208}
[0m20:39:29.951419 [debug] [MainThread]: Command `dbt run` failed at 20:39:29.951347 after 5.55 seconds
[0m20:39:29.951791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ae150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205bdc70>]}
[0m20:39:29.952124 [debug] [MainThread]: Flushing usage events
[0m20:39:30.416451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:13.874165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e90d0>]}


============================== 20:40:13.877738 | 5e37351a-195d-4ab5-b9b4-d48100878524 ==============================
[0m20:40:13.877738 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:40:13.878055 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/jaypatel/.dbt', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:14.367507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e0620>]}
[0m20:40:14.394240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bd220>]}
[0m20:40:14.394783 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:40:14.471436 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:40:14.527647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:14.527937 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:40:14.627464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109946cc0>]}
[0m20:40:14.651019 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:40:14.652329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:40:14.663677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096917f0>]}
[0m20:40:14.663906 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:40:14.664080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d12000>]}
[0m20:40:14.664842 [info ] [MainThread]: 
[0m20:40:14.665012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:14.665138 [info ] [MainThread]: 
[0m20:40:14.665351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:14.667255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:40:14.695392 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:40:14.695591 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:40:14.695726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:16.758237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.062 seconds
[0m20:40:16.761949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:40:16.775097 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:40:16.775464 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:40:16.887651 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.112 seconds
[0m20:40:16.897672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c6b10>]}
[0m20:40:16.903632 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:40:16.904351 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:40:16.904920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:40:16.905364 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:40:16.913147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:40:16.913983 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:40:16.938308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:40:16.939017 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:40:16.939274 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name as customer_name
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:40:17.819887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m20:40:17.850969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104687b00>]}
[0m20:40:17.851666 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m20:40:17.852174 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:40:17.852499 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:40:17.852963 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:40:17.853352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:40:17.853627 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:40:17.855090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:40:17.855708 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:40:17.857682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:40:17.858355 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:40:17.858703 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as order_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:40:18.090438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m20:40:18.095503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6aea50>]}
[0m20:40:18.096591 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.24s]
[0m20:40:18.097611 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:40:18.098146 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:40:18.098871 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:40:18.099491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:40:18.099955 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:40:18.102364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:40:18.103125 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:40:18.105862 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:40:18.106848 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:40:18.107219 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:40:18.436261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m20:40:18.442195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6bcb90>]}
[0m20:40:18.442828 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.34s]
[0m20:40:18.443320 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:40:18.443981 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:40:18.444381 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:40:18.444732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:40:18.445016 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:40:18.447993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:40:18.448607 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:40:18.452046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:40:18.453134 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:40:18.453444 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name ,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:40:18.686651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be96a4-0307-129d-0000-00049d8a3569
[0m20:40:18.687452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 12
invalid identifier 'C.NAME'
[0m20:40:18.693085 [debug] [Thread-1 (]: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:40:18.693756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e37351a-195d-4ab5-b9b4-d48100878524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6d4f20>]}
[0m20:40:18.694555 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model analytics.order_status .................... [[31mERROR[0m in 0.25s]
[0m20:40:18.695250 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:40:18.695926 [debug] [Thread-4 (]: Marking all children of 'model.dbt_ecommerce.order_status' to be skipped because of status 'error'.  Reason: Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql.
[0m20:40:18.697716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:18.698044 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:40:18.698336 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:40:18.819376 [info ] [MainThread]: 
[0m20:40:18.819970 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m20:40:18.821337 [debug] [MainThread]: Command end result
[0m20:40:18.841385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:40:18.842999 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:40:18.847775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:40:18.848004 [info ] [MainThread]: 
[0m20:40:18.848239 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:40:18.848435 [info ] [MainThread]: 
[0m20:40:18.848682 [error] [MainThread]: [31mFailure in model order_status (models/marts/order_status.sql)[0m
[0m20:40:18.848910 [error] [MainThread]:   Database Error in model order_status (models/marts/order_status.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'C.NAME'
  compiled code at target/run/dbt_ecommerce/models/marts/order_status.sql
[0m20:40:18.849086 [info ] [MainThread]: 
[0m20:40:18.849293 [info ] [MainThread]:   compiled code at target/compiled/dbt_ecommerce/models/marts/order_status.sql
[0m20:40:18.849463 [info ] [MainThread]: 
[0m20:40:18.849655 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m20:40:18.851245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0122933, "process_in_blocks": "0", "process_kernel_time": 0.255646, "process_mem_max_rss": "196558848", "process_out_blocks": "0", "process_user_time": 1.457197}
[0m20:40:18.851544 [debug] [MainThread]: Command `dbt run` failed at 20:40:18.851491 after 5.01 seconds
[0m20:40:18.851778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6ae060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6ad340>]}
[0m20:40:18.852002 [debug] [MainThread]: Flushing usage events
[0m20:40:19.390958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:24.172161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093053a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109305100>]}


============================== 20:41:24.175954 | 4946ae62-0051-4676-a69b-97c3c8e69525 ==============================
[0m20:41:24.175954 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:41:24.176262 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False'}
[0m20:41:24.677161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108604b30>]}
[0m20:41:24.702846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108606b10>]}
[0m20:41:24.703368 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:41:24.780155 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:41:24.835168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:24.835453 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stag_customer.sql
[0m20:41:24.934165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d665790>]}
[0m20:41:24.957437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:41:24.958808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:41:24.971359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d485490>]}
[0m20:41:24.971583 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:41:24.971750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf937d0>]}
[0m20:41:24.972506 [info ] [MainThread]: 
[0m20:41:24.972688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:24.972820 [info ] [MainThread]: 
[0m20:41:24.973031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:24.974956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:41:25.005374 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:41:25.005571 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:41:25.005705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:27.600226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.594 seconds
[0m20:41:27.605589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:41:27.621859 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:41:27.622346 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:41:27.744585 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.122 seconds
[0m20:41:27.751512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d109820>]}
[0m20:41:27.754632 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:41:27.755108 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:41:27.755494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:41:27.755794 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:41:27.761202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:41:27.761771 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:41:27.782205 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:41:27.782772 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:41:27.782996 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    customer_id as customer_id,
    name 
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:41:28.081499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m20:41:28.110461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11248ebd0>]}
[0m20:41:28.111062 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.35s]
[0m20:41:28.111523 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:41:28.111834 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:41:28.112258 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:41:28.112573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:41:28.112823 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:41:28.114108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:41:28.114577 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:41:28.116598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:41:28.117246 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:41:28.117503 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    order_id as order_id,
    customer_id as customer_id,
    order_date as order_date
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:41:28.477188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m20:41:28.482673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ba420>]}
[0m20:41:28.483957 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.37s]
[0m20:41:28.485039 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:41:28.485655 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:41:28.486418 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:41:28.487058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:41:28.487478 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:41:28.490218 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:41:28.491359 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:41:28.494948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:41:28.495992 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:41:28.496413 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    order_id as order_id,
    status,
    shipped_at,
    delivered_at
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:41:28.737381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m20:41:28.742413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d70b0>]}
[0m20:41:28.743204 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.26s]
[0m20:41:28.743806 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:41:28.744576 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:41:28.745101 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:41:28.745577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:41:28.745900 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:41:28.749001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:41:28.749716 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:41:28.753344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:41:28.754566 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:41:28.754932 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name ,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:41:29.244118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m20:41:29.248828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4946ae62-0051-4676-a69b-97c3c8e69525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d70b0>]}
[0m20:41:29.250045 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.order_status ........................ [[32mSUCCESS 1[0m in 0.50s]
[0m20:41:29.251253 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:41:29.253227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:29.253735 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:41:29.254113 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:41:29.382632 [info ] [MainThread]: 
[0m20:41:29.383350 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m20:41:29.384596 [debug] [MainThread]: Command end result
[0m20:41:29.403559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:41:29.405031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:41:29.409538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:41:29.409795 [info ] [MainThread]: 
[0m20:41:29.410047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:29.410253 [info ] [MainThread]: 
[0m20:41:29.410464 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:41:29.412066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.274338, "process_in_blocks": "0", "process_kernel_time": 0.256045, "process_mem_max_rss": "200474624", "process_out_blocks": "0", "process_user_time": 1.462702}
[0m20:41:29.412399 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:29.412339 after 5.27 seconds
[0m20:41:29.412635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109305130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d4e60>]}
[0m20:41:29.412871 [debug] [MainThread]: Flushing usage events
[0m20:41:29.865342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:10.113870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a687a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b95340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b950a0>]}


============================== 20:49:10.118556 | 909a1179-7dcc-45e1-a570-c7ff5f3528da ==============================
[0m20:49:10.118556 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:49:10.118917 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'profiles_dir': '/Users/jaypatel/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m20:49:10.670285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657d10>]}
[0m20:49:10.697334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c630980>]}
[0m20:49:10.697936 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:49:10.779116 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:49:10.854636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:49:10.855005 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_orders.sql
[0m20:49:10.855209 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stg_shipments.sql
[0m20:49:10.855382 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/staging/stag_customer.sql
[0m20:49:10.976544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfae690>]}
[0m20:49:11.001001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:49:11.004198 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:49:11.043488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ebe00>]}
[0m20:49:11.043742 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:49:11.043914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d07bd40>]}
[0m20:49:11.044720 [info ] [MainThread]: 
[0m20:49:11.044907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:11.045040 [info ] [MainThread]: 
[0m20:49:11.045262 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:11.047316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:49:11.096320 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:49:11.096568 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:49:11.096736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:13.949113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.852 seconds
[0m20:49:13.954658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:49:13.971532 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:49:13.972031 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:49:14.170732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m20:49:14.175091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfadee0>]}
[0m20:49:14.178111 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:49:14.178558 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:49:14.178986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:49:14.179275 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:49:14.186668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:49:14.187814 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:49:14.216592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:49:14.217399 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:49:14.217659 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    *
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:49:14.601257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m20:49:14.633370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112827680>]}
[0m20:49:14.634103 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.45s]
[0m20:49:14.634626 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:49:14.634950 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:49:14.635364 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:49:14.635687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:49:14.635953 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:49:14.637395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:49:14.637949 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:49:14.640076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:49:14.640752 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:49:14.641040 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    *
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:49:14.908832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m20:49:14.914268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128aa6c0>]}
[0m20:49:14.915403 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m20:49:14.916214 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:49:14.916794 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:49:14.917959 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:49:14.918816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:49:14.919301 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:49:14.921878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:49:14.922886 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:49:14.926111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:49:14.927434 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:49:14.928198 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    *
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:49:15.327832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m20:49:15.332162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ca930>]}
[0m20:49:15.333193 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.41s]
[0m20:49:15.334030 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:49:15.335155 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:49:15.336036 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:49:15.336668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:49:15.337123 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:49:15.342159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:49:15.343249 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:49:15.349549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:49:15.351121 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:49:15.351562 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name ,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:49:15.932476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m20:49:15.937717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '909a1179-7dcc-45e1-a570-c7ff5f3528da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e47a0>]}
[0m20:49:15.938852 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.order_status ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m20:49:15.939526 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:49:15.941243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:15.941795 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:49:15.942210 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:49:16.063685 [info ] [MainThread]: 
[0m20:49:16.064747 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m20:49:16.066473 [debug] [MainThread]: Command end result
[0m20:49:16.089476 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:49:16.091402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:49:16.097361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:49:16.097661 [info ] [MainThread]: 
[0m20:49:16.097969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:16.098170 [info ] [MainThread]: 
[0m20:49:16.098419 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:49:16.100495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0279665, "process_in_blocks": "0", "process_kernel_time": 0.312104, "process_mem_max_rss": "198983680", "process_out_blocks": "0", "process_user_time": 1.543089}
[0m20:49:16.100862 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:16.100795 after 6.03 seconds
[0m20:49:16.101143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b95160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e65850>]}
[0m20:49:16.101406 [debug] [MainThread]: Flushing usage events
[0m20:49:17.029938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:08.212235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104007110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d2b0>]}


============================== 20:55:08.216469 | 47732bbe-a652-403d-89ab-dcbbc3d3448b ==============================
[0m20:55:08.216469 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:55:08.216783 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/jaypatel/.dbt', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True'}
[0m20:55:08.781270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a823e60>]}
[0m20:55:08.809688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf29c0>]}
[0m20:55:08.810606 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:55:08.897793 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:55:08.959813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:08.960256 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:55:09.069614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064489e0>]}
[0m20:55:09.096120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:55:09.097868 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:55:09.110639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae27fe0>]}
[0m20:55:09.110943 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:55:09.111184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3ac60>]}
[0m20:55:09.112017 [info ] [MainThread]: 
[0m20:55:09.112195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:09.112322 [info ] [MainThread]: 
[0m20:55:09.112552 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:09.114667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:55:09.192026 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:55:09.192281 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:55:09.192429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:12.593893 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.401 seconds
[0m20:55:12.597822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:55:12.609745 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:55:12.610027 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:55:12.878845 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.268 seconds
[0m20:55:12.885908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae7dc40>]}
[0m20:55:12.889327 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stag_customer
[0m20:55:12.889980 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stag_customer ............................ [RUN]
[0m20:55:12.890516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stag_customer)
[0m20:55:12.890910 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stag_customer
[0m20:55:12.894995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stag_customer"
[0m20:55:12.895885 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stag_customer
[0m20:55:12.913321 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stag_customer"
[0m20:55:12.913874 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stag_customer"
[0m20:55:12.914064 [debug] [Thread-1 (]: On model.dbt_ecommerce.stag_customer: create or replace   view ecommerce_db.analytics.stag_customer
  
  
  
  
  as (
    select
    *
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stag_customer"} */;
[0m20:55:13.308694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m20:55:13.330871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd27170>]}
[0m20:55:13.331339 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stag_customer ....................... [[32mSUCCESS 1[0m in 0.44s]
[0m20:55:13.331938 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stag_customer
[0m20:55:13.332343 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:55:13.332771 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:55:13.333000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stag_customer, now model.dbt_ecommerce.stg_orders)
[0m20:55:13.333183 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:55:13.334135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:55:13.334921 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:55:13.336530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:55:13.337037 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:55:13.337241 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    *
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:55:13.717875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m20:55:13.721706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdba3f0>]}
[0m20:55:13.722626 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.39s]
[0m20:55:13.723442 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:55:13.724014 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:55:13.724842 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:55:13.725542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:55:13.726065 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:55:13.728722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:55:13.730199 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:55:13.731970 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:55:13.732586 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:55:13.732813 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    *
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:55:14.129031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m20:55:14.133035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd7200>]}
[0m20:55:14.134063 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.41s]
[0m20:55:14.135062 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:55:14.136154 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:55:14.137116 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:55:14.137761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:55:14.138291 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:55:14.141642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:55:14.142121 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:55:14.144812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:55:14.145518 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:55:14.145711 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
    SELECT  o.order_id,
            c.name AS customer_name,
            o.order_date,
            s.status,
            s.shipped_at,
            s.delivered_at,
            DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_time_hours
    FROM ecommerce_db.analytics.stg_orders o
    JOIN ecommerce_db.analytics.stag_customer c ON o.customer_id = c.customer_id
    JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id  

)

SELECT *,
         CASE 
              WHEN status = 'shipped' AND delivery_time_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:55:14.713231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m20:55:14.717324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47732bbe-a652-403d-89ab-dcbbc3d3448b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde4ce0>]}
[0m20:55:14.718273 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.order_status ........................ [[32mSUCCESS 1[0m in 0.58s]
[0m20:55:14.719107 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:55:14.720396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:14.720754 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:55:14.721097 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:55:14.878472 [info ] [MainThread]: 
[0m20:55:14.879134 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m20:55:14.880903 [debug] [MainThread]: Command end result
[0m20:55:14.897746 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:55:14.898786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:55:14.902104 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:55:14.902280 [info ] [MainThread]: 
[0m20:55:14.902467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:14.902605 [info ] [MainThread]: 
[0m20:55:14.902905 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:55:14.904426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7314143, "process_in_blocks": "0", "process_kernel_time": 0.325077, "process_mem_max_rss": "198803456", "process_out_blocks": "0", "process_user_time": 1.522553}
[0m20:55:14.904871 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:14.904790 after 6.73 seconds
[0m20:55:14.905192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e71f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdabef0>]}
[0m20:55:14.905509 [debug] [MainThread]: Flushing usage events
[0m20:55:15.386269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:19.631262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653d100>]}


============================== 20:56:19.635554 | 75fe603b-80b6-41ae-abf4-cfa68e81b59c ==============================
[0m20:56:19.635554 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:56:19.635884 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'fail_fast': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m20:56:20.162127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75fe603b-80b6-41ae-abf4-cfa68e81b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ccce0>]}
[0m20:56:20.191009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75fe603b-80b6-41ae-abf4-cfa68e81b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a97b00>]}
[0m20:56:20.192036 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:56:20.284255 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:56:20.350688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:20.351081 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:56:20.442253 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_ecommerce.order_status' (models/marts/order_status.sql) depends on a node named 'stg_customers' which was not found
[0m20:56:20.444350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8571847, "process_in_blocks": "0", "process_kernel_time": 0.241392, "process_mem_max_rss": "175554560", "process_out_blocks": "0", "process_user_time": 1.15773}
[0m20:56:20.444773 [debug] [MainThread]: Command `dbt run` failed at 20:56:20.444714 after 0.86 seconds
[0m20:56:20.445022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ee8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11488f1d0>]}
[0m20:56:20.445217 [debug] [MainThread]: Flushing usage events
[0m20:56:20.903558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:20.600175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108190320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f212b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f20fe0>]}


============================== 20:57:20.605446 | fe723469-1c7c-4e96-840c-2920ae3d6897 ==============================
[0m20:57:20.605446 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:57:20.605771 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'log_cache_events': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/Users/jaypatel/.dbt', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'debug': 'False'}
[0m20:57:21.347526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe723469-1c7c-4e96-840c-2920ae3d6897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce41700>]}
[0m20:57:21.374974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe723469-1c7c-4e96-840c-2920ae3d6897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107210620>]}
[0m20:57:21.375805 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:57:21.468852 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:57:21.547915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:21.548244 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:57:21.638792 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_ecommerce.order_status' (models/marts/order_status.sql) depends on a node named 'stg_customers' which was not found
[0m20:57:21.640674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0904882, "process_in_blocks": "0", "process_kernel_time": 0.263223, "process_mem_max_rss": "176881664", "process_out_blocks": "0", "process_user_time": 1.145803}
[0m20:57:21.641007 [debug] [MainThread]: Command `dbt run` failed at 20:57:21.640957 after 1.09 seconds
[0m20:57:21.641218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc87ce0>]}
[0m20:57:21.641395 [debug] [MainThread]: Flushing usage events
[0m20:57:22.201030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:48.264009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c87ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107589250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107588fb0>]}


============================== 20:57:48.270508 | 464c69cc-4fc5-4575-b881-68df2e219d7f ==============================
[0m20:57:48.270508 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:57:48.270840 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/jaypatel/.dbt', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run'}
[0m20:57:49.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '464c69cc-4fc5-4575-b881-68df2e219d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688a810>]}
[0m20:57:49.027377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '464c69cc-4fc5-4575-b881-68df2e219d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107696450>]}
[0m20:57:49.030243 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:57:49.135740 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:57:49.224905 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m20:57:49.225171 [debug] [MainThread]: Partial parsing: added file: dbt_ecommerce://models/staging/stg_customer.sql
[0m20:57:49.225345 [debug] [MainThread]: Partial parsing: deleted file: dbt_ecommerce://models/staging/stag_customer.sql
[0m20:57:49.225491 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:57:49.320125 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_ecommerce.order_status' (models/marts/order_status.sql) depends on a node named 'stg_customers' which was not found
[0m20:57:49.323103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1096163, "process_in_blocks": "0", "process_kernel_time": 0.226913, "process_mem_max_rss": "173375488", "process_out_blocks": "0", "process_user_time": 1.116345}
[0m20:57:49.323417 [debug] [MainThread]: Command `dbt run` failed at 20:57:49.323369 after 1.11 seconds
[0m20:57:49.323614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107588e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6101d0>]}
[0m20:57:49.323787 [debug] [MainThread]: Flushing usage events
[0m20:57:49.863954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:16.220450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ce60>]}


============================== 20:58:16.228936 | 64bf0f3f-c9e6-431c-b63d-2221d5b19b83 ==============================
[0m20:58:16.228936 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:58:16.229272 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/Users/jaypatel/.dbt', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m20:58:16.893569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bde20>]}
[0m20:58:16.919974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137dacf0>]}
[0m20:58:16.920529 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:58:17.037475 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:58:17.135791 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m20:58:17.136124 [debug] [MainThread]: Partial parsing: added file: dbt_ecommerce://models/staging/stg_customers.sql
[0m20:58:17.136296 [debug] [MainThread]: Partial parsing: deleted file: dbt_ecommerce://models/staging/stag_customer.sql
[0m20:58:17.136465 [debug] [MainThread]: Partial parsing: updated file: dbt_ecommerce://models/marts/order_status.sql
[0m20:58:17.248063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cc2db0>]}
[0m20:58:17.271821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:58:17.279575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:58:17.314970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11534fbc0>]}
[0m20:58:17.315192 [info ] [MainThread]: Found 4 models, 477 macros
[0m20:58:17.315358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153f1ca0>]}
[0m20:58:17.316139 [info ] [MainThread]: 
[0m20:58:17.316305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:17.316428 [info ] [MainThread]: 
[0m20:58:17.316639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:58:17.318662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m20:58:17.366805 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m20:58:17.367045 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m20:58:17.367187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:20.052751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.685 seconds
[0m20:58:20.057583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m20:58:20.069675 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m20:58:20.069930 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m20:58:20.191417 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.121 seconds
[0m20:58:20.198854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113acdc10>]}
[0m20:58:20.202808 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_customers
[0m20:58:20.204312 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_customers ............................ [RUN]
[0m20:58:20.204994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stg_customers)
[0m20:58:20.205400 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_customers
[0m20:58:20.208759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_customers"
[0m20:58:20.209213 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_customers
[0m20:58:20.227821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_customers"
[0m20:58:20.228773 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_customers"
[0m20:58:20.229025 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_customers: create or replace   view ecommerce_db.analytics.stg_customers
  
  
  
  
  as (
    select
    *
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_customers"} */;
[0m20:58:20.495960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m20:58:20.521880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326eea0>]}
[0m20:58:20.522501 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_customers ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m20:58:20.522998 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_customers
[0m20:58:20.523350 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m20:58:20.523849 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m20:58:20.524302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_customers, now model.dbt_ecommerce.stg_orders)
[0m20:58:20.524616 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m20:58:20.526162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m20:58:20.526706 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m20:58:20.528759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m20:58:20.529518 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m20:58:20.529859 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    *
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m20:58:20.776850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m20:58:20.782397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d11070>]}
[0m20:58:20.783128 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.26s]
[0m20:58:20.783720 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m20:58:20.784120 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m20:58:20.784654 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m20:58:20.785082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m20:58:20.785402 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m20:58:20.787039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m20:58:20.787680 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m20:58:20.789981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m20:58:20.793645 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m20:58:20.793922 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    *
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m20:58:21.418985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m20:58:21.425743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dc3e60>]}
[0m20:58:21.426697 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.64s]
[0m20:58:21.427453 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m20:58:21.428344 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m20:58:21.428936 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m20:58:21.429421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m20:58:21.429813 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m20:58:21.432435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m20:58:21.432956 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m20:58:21.435296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m20:58:21.436033 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m20:58:21.436235 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
  SELECT o.order_id, c.name AS customer_name, o.order_date, s.status,
         s.shipped_at, s.delivered_at,
         DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_hours
  FROM ecommerce_db.analytics.stg_orders o
  JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id
  JOIN ecommerce_db.analytics.stg_customers c ON o.customer_id = c.customer_id
)

SELECT *,
       CASE WHEN status = 'shipped' AND delivery_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m20:58:21.930710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m20:58:21.935070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64bf0f3f-c9e6-431c-b63d-2221d5b19b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df5190>]}
[0m20:58:21.936038 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.order_status ........................ [[32mSUCCESS 1[0m in 0.51s]
[0m20:58:21.936768 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m20:58:21.938142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:21.938518 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m20:58:21.938838 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m20:58:22.088146 [info ] [MainThread]: 
[0m20:58:22.089026 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m20:58:22.090692 [debug] [MainThread]: Command end result
[0m20:58:22.116014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m20:58:22.117938 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m20:58:22.129835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m20:58:22.130147 [info ] [MainThread]: 
[0m20:58:22.130431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:22.130632 [info ] [MainThread]: 
[0m20:58:22.130856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:58:22.135976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.967818, "process_in_blocks": "0", "process_kernel_time": 0.312268, "process_mem_max_rss": "199262208", "process_out_blocks": "0", "process_user_time": 1.506481}
[0m20:58:22.136424 [debug] [MainThread]: Command `dbt run` succeeded at 20:58:22.136347 after 5.97 seconds
[0m20:58:22.136712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104252c90>]}
[0m20:58:22.136973 [debug] [MainThread]: Flushing usage events
[0m20:58:22.591368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:26.509839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089410a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108940dd0>]}


============================== 21:27:26.513936 | e7030450-104a-4931-a3b8-40138da56be1 ==============================
[0m21:27:26.513936 [info ] [MainThread]: Running with dbt=1.10.9
[0m21:27:26.514265 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/jaypatel/.dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/logs'}
[0m21:27:27.170746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a01a0>]}
[0m21:27:27.201197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c88620>]}
[0m21:27:27.203472 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:27:27.291216 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m21:27:27.367757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:27.368002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:27.380116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cac00>]}
[0m21:27:27.408686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m21:27:27.410859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m21:27:27.431267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd41df0>]}
[0m21:27:27.431481 [info ] [MainThread]: Found 4 models, 477 macros
[0m21:27:27.431650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d37d0>]}
[0m21:27:27.432406 [info ] [MainThread]: 
[0m21:27:27.432583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:27.432723 [info ] [MainThread]: 
[0m21:27:27.432976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:27:27.434953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ecommerce_db'
[0m21:27:27.488366 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db"
[0m21:27:27.488584 [debug] [ThreadPool]: On list_ecommerce_db: show terse schemas in database ecommerce_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db"} */
[0m21:27:27.488720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:30.646904 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.158 seconds
[0m21:27:30.648911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_db, now list_ecommerce_db_analytics)
[0m21:27:30.661569 [debug] [ThreadPool]: Using snowflake connection "list_ecommerce_db_analytics"
[0m21:27:30.661854 [debug] [ThreadPool]: On list_ecommerce_db_analytics: show objects in ecommerce_db.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "connection_name": "list_ecommerce_db_analytics"} */;
[0m21:27:31.478116 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.816 seconds
[0m21:27:31.485492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f7f50>]}
[0m21:27:31.490882 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_customers
[0m21:27:31.491420 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_customers ............................ [RUN]
[0m21:27:31.491798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_db_analytics, now model.dbt_ecommerce.stg_customers)
[0m21:27:31.492176 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_customers
[0m21:27:31.496560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_customers"
[0m21:27:31.499203 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_customers
[0m21:27:31.517693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_customers"
[0m21:27:31.518320 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_customers"
[0m21:27:31.518515 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_customers: create or replace   view ecommerce_db.analytics.stg_customers
  
  
  
  
  as (
    select
    *
from raw.customers
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_customers"} */;
[0m21:27:31.809169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m21:27:31.836688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106403140>]}
[0m21:27:31.837342 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_customers ....................... [[32mSUCCESS 1[0m in 0.34s]
[0m21:27:31.837925 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_customers
[0m21:27:31.838287 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_orders
[0m21:27:31.838758 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.stg_orders ............................... [RUN]
[0m21:27:31.839169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_customers, now model.dbt_ecommerce.stg_orders)
[0m21:27:31.839459 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_orders
[0m21:27:31.841064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_orders"
[0m21:27:31.841629 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_orders
[0m21:27:31.843586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_orders"
[0m21:27:31.844299 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_orders"
[0m21:27:31.844606 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_orders: create or replace   view ecommerce_db.analytics.stg_orders
  
  
  
  
  as (
    select
    *
from raw.orders
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_orders"} */;
[0m21:27:32.078071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m21:27:32.082941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11256edb0>]}
[0m21:27:32.084183 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.stg_orders .......................... [[32mSUCCESS 1[0m in 0.24s]
[0m21:27:32.085747 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_orders
[0m21:27:32.086697 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.stg_shipments
[0m21:27:32.087563 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.stg_shipments ............................ [RUN]
[0m21:27:32.088144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_orders, now model.dbt_ecommerce.stg_shipments)
[0m21:27:32.088584 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.stg_shipments
[0m21:27:32.090548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.stg_shipments"
[0m21:27:32.091647 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.stg_shipments
[0m21:27:32.094744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.stg_shipments"
[0m21:27:32.095700 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.stg_shipments"
[0m21:27:32.096128 [debug] [Thread-1 (]: On model.dbt_ecommerce.stg_shipments: create or replace   view ecommerce_db.analytics.stg_shipments
  
  
  
  
  as (
    select
    *
from raw.shipments
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.stg_shipments"} */;
[0m21:27:32.500098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m21:27:32.504754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112654230>]}
[0m21:27:32.505451 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.stg_shipments ....................... [[32mSUCCESS 1[0m in 0.42s]
[0m21:27:32.505803 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.stg_shipments
[0m21:27:32.506200 [debug] [Thread-1 (]: Began running node model.dbt_ecommerce.order_status
[0m21:27:32.506480 [info ] [Thread-1 (]: 4 of 4 START sql view model analytics.order_status ............................. [RUN]
[0m21:27:32.506692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_ecommerce.stg_shipments, now model.dbt_ecommerce.order_status)
[0m21:27:32.506850 [debug] [Thread-1 (]: Began compiling node model.dbt_ecommerce.order_status
[0m21:27:32.508440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_ecommerce.order_status"
[0m21:27:32.508821 [debug] [Thread-1 (]: Began executing node model.dbt_ecommerce.order_status
[0m21:27:32.511193 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_ecommerce.order_status"
[0m21:27:32.511881 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_ecommerce.order_status"
[0m21:27:32.512082 [debug] [Thread-1 (]: On model.dbt_ecommerce.order_status: create or replace   view ecommerce_db.analytics.order_status
  
  
  
  
  as (
    WITH base AS (
  SELECT o.order_id, c.name AS customer_name, o.order_date, s.status,
         s.shipped_at, s.delivered_at,
         DATEDIFF('hour', s.shipped_at, s.delivered_at) AS delivery_hours
  FROM ecommerce_db.analytics.stg_orders o
  JOIN ecommerce_db.analytics.stg_shipments s ON o.order_id = s.order_id
  JOIN ecommerce_db.analytics.stg_customers c ON o.customer_id = c.customer_id
)

SELECT *,
       CASE WHEN status = 'shipped' AND delivery_hours > 48 THEN 'DELAYED' ELSE status END AS final_status
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ecommerce", "target_name": "dev", "node_id": "model.dbt_ecommerce.order_status"} */;
[0m21:27:33.113509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m21:27:33.177941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7030450-104a-4931-a3b8-40138da56be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d4c80>]}
[0m21:27:33.178346 [info ] [Thread-1 (]: 4 of 4 OK created sql view model analytics.order_status ........................ [[32mSUCCESS 1[0m in 0.67s]
[0m21:27:33.178647 [debug] [Thread-1 (]: Finished running node model.dbt_ecommerce.order_status
[0m21:27:33.179215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:33.179406 [debug] [MainThread]: Connection 'model.dbt_ecommerce.order_status' was left open.
[0m21:27:33.179563 [debug] [MainThread]: On model.dbt_ecommerce.order_status: Close
[0m21:27:33.313122 [info ] [MainThread]: 
[0m21:27:33.313637 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m21:27:33.314660 [debug] [MainThread]: Command end result
[0m21:27:33.339966 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/manifest.json
[0m21:27:33.341375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/semantic_manifest.json
[0m21:27:33.348381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Data Engineering /VS Project/Airflow/ECOMMERCE_PROJECT_TUT/dbt_ecommerce/target/run_results.json
[0m21:27:33.348613 [info ] [MainThread]: 
[0m21:27:33.348848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:33.349034 [info ] [MainThread]: 
[0m21:27:33.349238 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:27:33.353779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8914514, "process_in_blocks": "0", "process_kernel_time": 0.328778, "process_mem_max_rss": "196591616", "process_out_blocks": "0", "process_user_time": 1.401287}
[0m21:27:33.354053 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:33.354001 after 6.89 seconds
[0m21:27:33.354267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8cd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95d070>]}
[0m21:27:33.354677 [debug] [MainThread]: Flushing usage events
[0m21:27:33.941813 [debug] [MainThread]: An error was encountered while trying to flush usage events
